#!/usr/bin/python3

import requests
import json

def query_domains(ip):
    url = f"https://api.webscan.cc?action=query&ip={ip}"
    response = requests.get(url)

    if response.status_code == 200:
        data = response.json()
        urls = [entry['domain'] for entry in data]

        # Sort and make URLs unique
        urls = sorted(set(urls))

        # Print the sorted URLs
        for url in urls:
            print(url)

        # Write the sorted URLs to webscan_result.txt
        with open('webscan_result.txt', 'w') as outfile:
            for url in urls:
                outfile.write(url + '\n')

        print("\n[+] Sorted URLs have been written to webscan_result.txt")
    else:
        print("Failed to retrieve data. Status code:", response.status_code)

if __name__ == "__main__":
    ip = input("Enter the IP address: ")
    query_domains(ip)
